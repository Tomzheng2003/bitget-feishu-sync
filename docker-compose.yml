# Bitget-飞书交易同步服务 Docker Compose 配置
# 使用方法: docker-compose up -d --build

services:
  trade-sync:
    # 从当前目录构建镜像
    build: .
    
    # 容器名称
    container_name: bitget-feishu-sync
    
    # 自动重启策略
    restart: always
    
    # 挂载卷
    volumes:
      # 持久化状态文件
      - ./data/state.json:/app/state.json
      # 持久化日志目录
      - ./data/logs:/app/logs
    
    # host 网络模式：直接使用群晖宿主机的网络栈
    # 这样可以直接访问 127.0.0.1 (如果代理在宿主机) 和局域网 IP
    network_mode: "host"
    
    # 从配置文件读取环境变量
    env_file:
      - config.env
    
    # 额外环境变量
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Shanghai
      - HTTP_PROXY=${HTTP_PROXY}
      - HTTPS_PROXY=${HTTPS_PROXY}
    
    # 日志配置
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
